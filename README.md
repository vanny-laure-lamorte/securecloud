# Secure Cloud

_Secure Cloud is an ultra-secure communication platform designed for MÃ©decins Sans FrontiÃ¨res (MSF). It ensures complete confidentiality of communications, even in conflict zones, on older hardware and with low-bandwidth connections._

Available Languages
- French
- English
- Spanish

---

### ğŸ“ŒTable of Contents

- [Features](#âœ…features)
- [Architecture](#ğŸ§±architecture)
- [Requirements](#âš™ï¸requirements)
- [Installation & Launch](#ğŸš€installation--launch)
- [Usage](#âš’ï¸usage)
- [Project Structure](#ğŸ“project-structure)
- [Translation](#ğŸŒtranslation)
- [Routes](#ğŸŒroutes)
- [Tests](#ğŸ§ªtests)
- [Team](#ğŸ‘¥team)
- [Useful Links](#ğŸ”—useful-links)
- [License](#ğŸ“„license)

---

### âœ…Features

- End-to-end encrypted messaging (AES-256)
- Secure file sharing (streaming + compression)
- Strong authentication (JWT + MFA)
- Native Qt interface (Windows/Linux/macOS)
- High-performance C++ microservices architecture
- Automated CI/CD deployment (Docker)

---

### ğŸ§±Architecture

Qt Client (UI)  
â”‚  
API Gateway (JWT + Routing)  
â”œâ”€â”€ auth-service  
â”œâ”€â”€ messaging-service  
â”œâ”€â”€ files-service  
â”œâ”€â”€ audit-service  
â””â”€â”€ deploy-service  

---

### âš™ï¸Requirements

- [Docker](https://www.docker.com/) & [Docker Compose](https://docs.docker.com/compose/)
- Qt 5 or 6
- CMake
- Git

---

### ğŸš€Installation & Launch

#### CMake

**Create the build directory**

- In CMake, select "GCC 14.2.0 x86_64-mingw32 (mingw32)"
- In the terminal, run the following commands:

```bash
mkdir build
cd build
cmake --build .
.\services\<>\messaging-service.exe
```

#### Docker

#### Sqitch

1. TÃ©lÃ©charger lâ€™image Docker de Sqitch
```bash
docker pull sqitch/sqitch:latest
```
2. VÃ©rifier que Sqitch est bien installÃ© et voir sa version
```bash
docker run --rm -it sqitch/sqitch:latest --version
```
3. Cette commande permet de crÃ©er un dossier 'migrations' qui contiendra:
    - 3 sous dossiers de configuration (deploy, revert et verify)
    - fichier sqitch.conf
    - fichier sqitch.plan

   remplacer <path> par le chemin souhaitÃ©. Dans notre cas "\services\auth-service" pour crÃ©er un dossier migrations dans auth-service.

```bash
docker run --rm -it `
  -v "${PWD}/<path>\migrations:/repo" `
  -w /repo `
  sqitch/sqitch:latest init auth pg
```

4. GÃ©nÃ©rer des scripts de migrations dans deploy, revert et verify. Voici le nommage des fichiers "<date du jour>_version_migrations"
```bash
docker run --rm -it `
  -v "${PWD}/<path>/migrations:/repo" `
  -w /repo `
  sqitch/sqitch:latest add "$(Get-Date -Format yyyyMMdd)_version_migrations" -n "Create table x"
```
5. Modifier le fichier sqitch.conf en de-commantant le contenu et en spÃ©cifiant 'engine'. Dans notre cas on mettre 'pg' pour Postegres.
```bash
[core]
	engine = pg
	plan_file = sqitch.plan
	top_dir = .
```
6. VÃ©rifier que le nom des 3 fichiers .sql correspond Ã  ceux dans squitch.plan.
Dans notre cas les fichiers portent le nom de '20251031_version_migrations'. Voici le squitch.plan

```bash
%syntax-version=1.0.0
%project=auth

20251031_version_migrations 2025-10-31T13:34:46Z sqitch <sqitch@53cf65d3ae71>

```

7. Supprimer '-- XXX Add DDLs here.' et remplir les 3 fichiers sql

```bash

# Deploy
-- Generated by the database client.
CREATE TABLE connexion(
    id SERIAL NOT NULL,
    email varchar(255) NOT NULL,
    password varchar(255) NOT NULL,
    account_status varchar(50) DEFAULT 'active'::character varying,
    login_time timestamp without time zone DEFAULT CURRENT_TIMESTAMP,
    logout_time timestamp without time zone,
    user_id integer NOT NULL,
    PRIMARY KEY(id)
);

# Revert

DROP TABLE IF EXISTS connexion;

# Verify

SELECT 1 FROM connexion LIMIT 1;

```

8. DÃ©ployer les migrations sur PostgreSQL. Remplacer <action> par:
    - deploy: lancer les scripts de crÃ©ation ou de modification
    - revert: annuler les changements faits dans deploy/
    -verify: vÃ©rifier que la migration sâ€™est bien appliquÃ©e
Si cette commande ne fonctionne pas, supprimer le registre Sqitch
```bash
$pw = Get-Content ./secrets/auth_db_password.txt -Raw
docker run --rm -it `
  -v "${PWD}/services/auth-service/migrations:/repo" `
  --network securecloud_default `
  -e PGPASSWORD="$pw" `
  sqitch/sqitch:latest `
  <action> db:pg://postgres@auth-db:5432/auth_service --chdir /repo/
```

9. DÃ©ployer les migrations sur PostgreSQL. Si cette commande ne fonctionne pas, supprimer le registre Sqitch
```bash
$pw = Get-Content ./secrets/auth_db_password.txt -Raw
docker run --rm -it `
  -v "${PWD}/services/auth-service/migrations:/repo" `
  --network securecloud_default `
  -e PGPASSWORD="$pw" `
  sqitch/sqitch:latest `
  deploy db:pg://postgres@auth-db:5432/auth_service --chdir /repo/
```

#### Qt

---

### âš’ï¸Usage
- Launch the compiled Qt interface
- Log in with an existing user
- Send encrypted messages or files
- Access logs via audit-service if authorized

---

### ğŸ“Project Structure

securecloud/  
â”œâ”€â”€ tests/  
â”œâ”€â”€ docs/  
â””â”€â”€ README.md  

#### ğŸ“ Conventions

##### ğŸ”€ Branch Naming

#### ğŸ§¾ Commit Naming

âœ¨feat(auth): description to add
â€¢ text
â€¢ text

1. Gitmoji  
2. Type  
    feat: new feature  
    fix: bug fix  
    refactor: code refactoring (no behavior change)  
    docs: documentation update  
    style: formatting changes (indentation, spaces, etc.)  
    test: add/modify tests  
    chore: tasks with no direct functional impact (dependency updates, configs, etc.)  
3. Scope: auth/login/ui etc.  
4. Message  
    - Sentence starting with a lowercase letter  
    - No period at the end  
    - Use single quotes for terms (e.g., 'token', 'userId')  

---

### ğŸŒTranslation

#### How to Translate

- Ensure that `lupdate ` and `lrelease` are available in our system `PATH`
```
$env:PATH="C:\Qt\6.7.1\mingw_64\bin;" + $env:PATH
```
- Check if the source file exists
```
dir client\src\main.cpp
```
- Extract all translation keys into the `.ts` files
```
lupdate client/src/main.cpp -ts common/i18n/es_ES.ts common/i18n/fr_FR.ts common/i18n/en_US.ts
```
- Compile the `.ts` files into `.qm` files
```
lrelease common/i18n/en_US.ts common/i18n/fr_FR.ts common/i18n/es_ES.ts
```
- compile traductions
```
cmake --build build --target client
```

---

### ğŸŒRoutes

| Action | Route | Description |
|--------|-------|-------------|
| **GET** | `/` | Return Gateway Status |
| **GET** | `/auth/ping` | Return Authentification-service Status |
| **GET** | `/messaging/ping` | Return Messaging-service Status |
| **POST** | `/audit/services` | Logs services status into Audit database |
| **GET** | `/audit/services` | Fetch services status from Audit database |

---

### ğŸ§ªTests

---

### ğŸ‘¥Team

- Lucas MARTINIE DE MAISONNEUVE

- Vanny LAMORTE

---

### ğŸ”—Useful Links

#### [Lien vers QT](https://www.qt.io/)
#### [Lien vers QT](https://www.qt.io/)

---

### ğŸ“„License

All rights reserved Â© 2025 SecureCloud Team.

---


